<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Reaction Game</title>
<style>
body {
  background: #1e1e1e;
  color: white;
  font-family: Arial, sans-serif;
  text-align: center;
  margin: 0;
  padding: 0;
}
#gameContainer {
  position: relative;
  width: 500px;
  height: 400px;
  margin: 50px auto;
  border: 3px solid #fff;
  background: #2e2e2e;
  overflow: hidden;
  border-radius: 10px;
}
#reactionBox {
  position: absolute;
  width: 80px;
  height: 80px;
  background: #ff4444;
  border-radius: 10px;
  display: none;
  cursor: pointer;
  transition: transform 0.1s;
}
.particle {
  position: absolute;
  width: 6px;
  height: 6px;
  border-radius: 50%;
  pointer-events: none;
  animation: particleAnim 0.6s forwards;
}
@keyframes particleAnim {
  0% { transform: translate(0,0); opacity:1; }
  100% { transform: translate(var(--dx), var(--dy)); opacity:0; }
}
h1, h2 {
  margin: 10px;
}
#startButton {
  padding: 10px 20px;
  font-size: 18px;
  cursor: pointer;
  margin-top: 20px;
}
</style>
</head>
<body>

<h1>‚ö° Reaction Game</h1>
<h2>Score: <span id="score">0</span> | High Score: <span id="highScore">0</span></h2>
<div id="gameContainer">
  <div id="reactionBox"></div>
</div>
<button id="startButton">Start Game</button>

<!-- sound effect -->
<audio id="clickSound" src="https://freesound.org/data/previews/256/256113_3263906-lq.mp3"></audio>

<script>
let score = 0;
let highScore = localStorage.getItem('reactionHighScore') || 0;
document.getElementById('highScore').innerText = highScore;

let gameTime = 30; // 30 seconds game
let timerRunning = false;
let streak = 0;
let boxTimeout;
let boxSpeed = 1000;

const gameContainer = document.getElementById('gameContainer');
const reactionBox = document.getElementById('reactionBox');
const startButton = document.getElementById('startButton');
const clickSound = document.getElementById('clickSound');

function startGame() {
  score = 0;
  streak = 0;
  document.getElementById('score').innerText = score;
  startButton.style.display = 'none';
  timerRunning = true;
  setTimeout(endGame, gameTime * 1000);
  spawnBox();
}

function spawnBox() {
  if (!timerRunning) return;

  // Random position
  const x = Math.random() * (gameContainer.clientWidth - 80);
  const y = Math.random() * (gameContainer.clientHeight - 80);
  reactionBox.style.left = x + 'px';
  reactionBox.style.top = y + 'px';

  // Random color
  reactionBox.style.background = `hsl(${Math.random()*360}, 80%, 50%)`;

  reactionBox.style.display = 'block';
  reactionBox.style.transform = 'scale(1)';

  // Move box after timeout if not clicked
  boxTimeout = setTimeout(() => {
    reactionBox.style.display = 'none';
    streak = 0;
    spawnBox();
  }, boxSpeed);
}

function createParticles(x, y) {
  for(let i=0; i<15; i++){
    const p = document.createElement('div');
    p.classList.add('particle');
    const dx = (Math.random() - 0.5) * 100 + 'px';
    const dy = (Math.random() - 0.5) * 100 + 'px';
    p.style.left = x + 'px';
    p.style.top = y + 'px';
    p.style.background = `hsl(${Math.random()*360}, 80%, 50%)`;
    p.style.setProperty('--dx', dx);
    p.style.setProperty('--dy', dy);
    gameContainer.appendChild(p);
    setTimeout(() => p.remove(), 600);
  }
}

reactionBox.addEventListener('click', (e) => {
  clearTimeout(boxTimeout);

  // Play sound
  clickSound.currentTime = 0;
  clickSound.play();

  // Particle effect
  const boxRect = reactionBox.getBoundingClientRect();
  const containerRect = gameContainer.getBoundingClientRect();
  const x = boxRect.left - containerRect.left + boxRect.width/2;
  const y = boxRect.top - containerRect.top + boxRect.height/2;
  createParticles(x, y);

  // Score & feedback
  reactionBox.style.transform = 'scale(1.2)';
  score += 1 + streak;
  streak += 1;
  document.getElementById('score').innerText = score;

  // speed up
  boxSpeed = Math.max(400, boxSpeed - 20);

  reactionBox.style.display = 'none';
  setTimeout(spawnBox, 300);
});

function endGame() {
  timerRunning = false;
  reactionBox.style.display = 'none';
  startButton.style.display = 'inline-block';
  if(score > highScore){
    highScore = score;
    localStorage.setItem('reactionHighScore', highScore);
    document.getElementById('highScore').innerText = highScore;
    alert(`üéâ New High Score: ${score}!`);
  } else {
    alert(`‚è±Ô∏è Time's up! Score: ${score}`);
  }
  boxSpeed = 1000;
}

startButton.addEventListener('click', startGame);
</script>

</body>
</html>
